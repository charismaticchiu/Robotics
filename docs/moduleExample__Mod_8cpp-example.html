<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Aria: moduleExample_Mod.cpp</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>moduleExample_Mod.cpp</h1>This is a simple example of how to define a module of code that Aria's <a class="el" href="classArModuleLoader.html">ArModuleLoader</a> class can dynamically load at runtime. On Windows, loadable modules are DLL files. On Linux, they are shared object (.so) files (ARIA's Makefiles can compile any source file ending in "Mod.cpp" into a .so, so to build this module, run "make moduleExample_Mod.so"). <a class="el" href="classArModuleLoader.html">ArModuleLoader</a> knows about these platform conventions, so only the base name (without the .dll or .so suffix) is used to load it. To implement a loadable module, you derive a class from <a class="el" href="classArModule.html">ArModule</a>, instantiate the pure virtual functions init() and exit(), and create an instance of that class. The two functions simply print out the equivalent of Hello World. An important part is the global instance of the class and the call to the macro ARDEF_MODULE(). Without that macro invocation, <a class="el" href="classAria.html">Aria</a> will never be able to invoke those two functions.<p>
The program <a class="el" href="moduleExample_8cpp.html">moduleExample.cpp</a> is designed to load this module and check the error return.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="moduleExample_8cpp.html">moduleExample.cpp</a>. <p>
<a class="el" href="classArModule.html">ArModule</a> in the reference manual.</dd></dl>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include "Aria.h"</span>


<span class="keyword">class </span>SimpleMod : <span class="keyword">public</span> <a name="_a464"></a><a class="code" href="classArModule.html">ArModule</a>
{
<span class="keyword">public</span>:

  <span class="keywordtype">bool</span> init(<a name="_a465"></a><a class="code" href="classArRobot.html">ArRobot</a> *robot, <span class="keywordtype">void</span> *argument = NULL);
  <span class="keywordtype">bool</span> exit();
};

SimpleMod aModule;
ARDEF_MODULE(aModule);

<span class="keywordtype">bool</span> <a name="a466"></a><a class="code" href="classArModule.html#a3">SimpleMod::init</a>(<a class="code" href="classArRobot.html">ArRobot</a> *robot, <span class="keywordtype">void</span> *argument)
{
  <a name="a467"></a><a class="code" href="classArLog.html#e4">ArLog::log</a>(<a name="a468"></a><a class="code" href="classArLog.html#w2w8">ArLog::Terse</a>, <span class="stringliteral">"module: init(%p) called in the loaded module!"</span>, robot);
  <span class="keywordflow">if</span> (argument != NULL)
    <a class="code" href="classArLog.html#e4">ArLog::log</a>(<a class="code" href="classArLog.html#w2w8">ArLog::Terse</a>, <span class="stringliteral">"module: Argument given to ArModuleLoader::load was the string '%s'."</span>, 
       (<span class="keywordtype">char</span> *)argument);
  <span class="keywordflow">else</span>
    <a class="code" href="classArLog.html#e4">ArLog::log</a>(ArLog::Terse, <span class="stringliteral">"module: No argument was given to ArModuleLoader (this is OK)."</span>);
    
  <span class="comment">// Do stuff here...</span>
    
  <span class="keywordflow">return</span>(<span class="keyword">true</span>);
}

<span class="keywordtype">bool</span> <a name="a469"></a><a class="code" href="classArModule.html#a1">SimpleMod::exit</a>()
{
  <a class="code" href="classArLog.html#e4">ArLog::log</a>(<a class="code" href="classArLog.html#w2w8">ArLog::Terse</a>, <span class="stringliteral">"module: exit() called."</span>);

  <span class="comment">// Do stuff here...</span>

  <span class="keywordflow">return</span>(<span class="keyword">true</span>);
}
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Thu Jan 7 10:34:38 2010 for Aria by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
